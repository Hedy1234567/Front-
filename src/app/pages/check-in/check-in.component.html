<button class="back-btn" (click)="goBack()">← Back to Home</button>

<form [formGroup]="checkInForm" (ngSubmit)="onSubmit()">
  <h1>Hotel Check-In</h1>

  <div>
    <label for="fullName">Full Name</label>
    <input id="fullName" type="text" formControlName="full_name" />
    <div class="error-message" *ngIf="formControls['full_name'].touched && formControls['full_name']?.invalid">
      Name must be at least 3 characters.
    </div>
  </div>

  <div>
    <label for="email">Email</label>
    <input id="email" type="email" formControlName="email" />
    <div class="error-message" *ngIf="formControls['email'].touched && formControls['email']?.invalid">
      Valid email is required.
    </div>
  </div>

  <div>
    <label for="phoneNumber">Phone Number</label>
    <input id="phoneNumber" type="text" formControlName="phone_number" />
    <div class="error-message" *ngIf="formControls['phone_number'].touched && formControls['phoneNumber']?.invalid">
      Valid phone number is required.
    </div>
  </div>

  <div>
    <label for="bookingReference">Booking Reference</label>
    <input id="bookingReference" type="number" formControlName="booking_reference_number" />
  </div>

  <div class="date-group">
    <div>
      <label for="checkInDate">Check-in Date</label>
      <input id="checkInDate" type="date" formControlName="check_in_date" />
    </div>
    <div>
      <label for="checkOutDate">Check-out Date</label>
      <input id="checkOutDate" type="date" formControlName="check_out_date" />
    </div>
  </div>

  <div>
    <label for="numberOfGuests">Number of Guests</label>
    <input id="numberOfGuests" type="number" formControlName="number_of_guests" />
  </div>

  <div>
    <label for="idType">ID Type</label>
    <select id="idType" formControlName="id_type">
      <option value="" disabled selected>Select ID Type</option>
      <option value="passport">Passport</option>
      <option value="driverLicense">Driver's License</option>
    </select>
  </div>

  <!-- Removed ID number field -->

  <div>
    <label for="roomType">Room Type</label>
    <select id="roomType" formControlName="room_type">
      <option value="" disabled selected>Select Room Type</option>
      <option value="single">Single</option>
      <option value="double">Double</option>
      <option value="suite">Suite</option>
    </select>
  </div>

  <fieldset>
    <legend>Preferences</legend>
    <div class="checkbox-group">
      <label><input type="checkbox"  /> Non-Smoking Room</label>
      <label><input type="checkbox"  /> High Floor</label>
      <label><input type="checkbox"  /> Near Elevator</label>
    </div>
  </fieldset>

  <fieldset>
    <legend>Extras</legend>
    <div class="checkbox-group">
      <label><input type="checkbox"  /> Breakfast</label>
      <label><input type="checkbox" /> Airport Pickup</label>
      <label><input type="checkbox" /> Spa Access</label>
      <label><input type="checkbox"  /> Late Checkout</label>
    </div>
  </fieldset>

  <div>
    <label for="specialRequests">Special Requests</label>
    <textarea id="specialRequests" ></textarea>
  </div>

  <div class="terms">
    <input type="checkbox" id="agreeTerms" />
    <label for="agreeTerms">I agree to the terms and conditions</label>
  </div>

 
  <!-- ✅ Carte Bancaire Upload -->
  <div>
    <label for="rectoUpload">Upload Front Card</label>
    <input type="file" id="rectoUpload" (change)="onRectoSelected($event)" accept="image/*" />
  </div>
  <div>
    <label for="versoUpload">Upload Back Card</label>
    <input type="file" id="versoUpload" (change)="onVersoSelected($event)" accept="image/*" />
  </div>

  <div *ngIf="rectoText === 'Extraction in progress...'">
    <span style="color: #1976d2; font-weight: bold;">Extraction in progress...</span>
  </div>

  <!-- Affichage des données extraites du recto sous forme de labels -->
  <div *ngIf="apiCardData">
    <div><strong>Card Number :</strong> <span *ngIf="apiCardData.num_carte; else noNum">{{ apiCardData.num_carte }}</span><ng-template #noNum><em style="color:red">Non détecté</em></ng-template></div>
    <div><strong>Expiration Date :</strong> <span *ngIf="apiCardData.date_expiration; else noDate">{{ apiCardData.date_expiration }}</span><ng-template #noDate><em style="color:red">Non détectée</em></ng-template></div>
    <div><strong>Card Security Code :</strong> <span *ngIf="apiCardData.cvv; else noCvv">{{ apiCardData.cvv }}</span><ng-template #noCvv><em style="color:red">Non détecté</em></ng-template></div>
    <div><strong>Cardholder :</strong> <span *ngIf="apiCardData.titulaire; else noTitulaire">{{ apiCardData.titulaire }}</span><ng-template #noTitulaire><em style="color:red">Non détecté</em></ng-template></div>
  </div>

  <button type="submit" (click)="onSubmit()">Submit</button>
</form>